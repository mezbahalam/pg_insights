<div id="compare-view" class="view-content" style="display: none;">
  <div class="compare-container">
    <!-- Query Selection Header -->
    <div class="compare-header">
      <div class="query-selector">
        <div class="query-card query-a">
          <div class="query-label">Query A</div>
          <div class="query-title" id="compare-title-a">Select a query</div>
          <div class="query-summary" id="compare-summary-a"></div>
        </div>
        
        <div class="vs-indicator">
          <span class="vs-text">VS</span>
          <button class="swap-btn" onclick="swapQueries()" title="Swap queries">
            üîÑ
          </button>
        </div>
        
        <div class="query-card query-b">
          <div class="query-label">Query B</div>
          <div class="query-title" id="compare-title-b">Select a query</div>
          <div class="query-summary" id="compare-summary-b"></div>
        </div>
      </div>
      
      <div class="compare-actions">
        <button class="btn-analyze" onclick="performComparison()">
          üìä Analyze Comparison
        </button>
      </div>
    </div>

    <!-- Comparison Results -->
    <div id="comparison-results" class="comparison-results" style="display: none;">
      <!-- Enhanced Performance Dashboard -->
      <div class="performance-comparison">
        <h4>‚ö° Performance Metrics</h4>
        
        <!-- Quick Stats Overview -->
        <div class="metrics-overview">
          <div class="metric-card" id="time-metric">
            <div class="metric-label">Execution Time</div>
            <div class="metric-values">
              <span class="value-a">-</span>
              <span class="vs-divider">vs</span>
              <span class="value-b">-</span>
            </div>
            <div class="metric-difference"></div>
          </div>
          
          <div class="metric-card" id="cost-metric">
            <div class="metric-label">Query Cost</div>
            <div class="metric-values">
              <span class="value-a">-</span>
              <span class="vs-divider">vs</span>
              <span class="value-b">-</span>
            </div>
            <div class="metric-difference"></div>
          </div>
          
          <div class="metric-card" id="rows-metric">
            <div class="metric-label">Rows Processed</div>
            <div class="metric-values">
              <span class="value-a">-</span>
              <span class="vs-divider">vs</span>
              <span class="value-b">-</span>
            </div>
            <div class="metric-difference"></div>
          </div>
          
          <div class="metric-card" id="efficiency-metric">
            <div class="metric-label">Efficiency Ratio</div>
            <div class="metric-values">
              <span class="value-a">-</span>
              <span class="vs-divider">vs</span>
              <span class="value-b">-</span>
            </div>
            <div class="metric-difference"></div>
          </div>
        </div>

        <!-- Detailed Metrics Table -->
        <div class="detailed-metrics">
          <h5>Detailed Breakdown</h5>
          <div class="metrics-table-wrapper">
            <table class="metrics-table">
              <thead>
                <tr>
                  <th>Metric</th>
                  <th>Query A</th>
                  <th>Query B</th>
                  <th>Difference</th>
                  <th>Impact</th>
                </tr>
              </thead>
              <tbody id="metrics-table-body">
                <!-- Dynamically populated -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Winner Summary -->
      <div class="winner-summary" id="winner-summary">
        <div class="winner-badge">
          <span class="winner-icon">üèÜ</span>
          <span class="winner-text">Query A performs better overall</span>
        </div>
      </div>

      <!-- Enhanced Plan Comparison -->
      <div class="plans-comparison">
        <h4>üå≥ Execution Plan Analysis</h4>
        
        <!-- Plan Overview -->
        <div class="plan-overview">
          <div class="plan-stats">
            <div class="stat-item">
              <span class="stat-label">Plan Nodes:</span>
              <span class="stat-values">
                <span id="nodes-a">-</span> vs <span id="nodes-b">-</span>
              </span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Max Depth:</span>
              <span class="stat-values">
                <span id="depth-a">-</span> vs <span id="depth-b">-</span>
              </span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Scan Types:</span>
              <span class="stat-values">
                <span id="scans-a">-</span> vs <span id="scans-b">-</span>
              </span>
            </div>
          </div>
          
          <div class="plan-controls">
            <button class="plan-toggle active" data-view="side-by-side">Side by Side</button>
            <button class="plan-toggle" data-view="overlay">Overlay</button>
            <button class="plan-toggle" data-view="diff">Differences</button>
          </div>
        </div>

        <!-- Side by Side Plans -->
        <div class="plans-grid" id="side-by-side-view">
          <div class="plan-column">
            <div class="plan-header">
              <h5>Query A Plan</h5>
              <div class="plan-meta">
                <span class="plan-efficiency" id="efficiency-a">-</span>
                <span class="plan-bottleneck" id="bottleneck-a">-</span>
              </div>
            </div>
            <div class="plan-content" id="plan-a-content">
              <!-- Plan tree content -->
            </div>
          </div>
          <div class="plan-column">
            <div class="plan-header">
              <h5>Query B Plan</h5>
              <div class="plan-meta">
                <span class="plan-efficiency" id="efficiency-b">-</span>
                <span class="plan-bottleneck" id="bottleneck-b">-</span>
              </div>
            </div>
            <div class="plan-content" id="plan-b-content">
              <!-- Plan tree content -->
            </div>
          </div>
        </div>

        <!-- Plan Overlay View -->
        <div class="plan-overlay" id="overlay-view" style="display: none;">
          <div class="overlay-controls">
            <div class="overlay-legend">
              <span class="legend-item">
                <span class="legend-color query-a-color"></span> Query A
              </span>
              <span class="legend-item">
                <span class="legend-color query-b-color"></span> Query B
              </span>
              <span class="legend-item">
                <span class="legend-color common-color"></span> Common
              </span>
            </div>
            <div class="overlay-options">
              <label>
                <input type="checkbox" id="highlight-differences" checked> Highlight Differences
              </label>
              <label>
                <input type="checkbox" id="show-metrics" checked> Show Metrics
              </label>
            </div>
          </div>
          
          <div class="overlay-content" id="overlay-content">
            <!-- Populated by JavaScript -->
          </div>
        </div>

        <!-- Plan Differences View -->
        <div class="plan-differences" id="diff-view" style="display: none;">
          <div class="diff-summary" id="diff-summary">
            <!-- Populated by JavaScript -->
          </div>
          <div class="diff-details" id="diff-details">
            <!-- Populated by JavaScript -->
          </div>
        </div>
      </div>

      <!-- Advanced Optimization Insights -->
      <div class="insights-comparison" id="insights-section">
        <h4>üí° Optimization Analysis</h4>
        
        <!-- Optimization Score -->
        <div class="optimization-score">
          <div class="score-card">
            <div class="score-header">Query A Optimization</div>
            <div class="score-value" id="score-a">-</div>
            <div class="score-grade" id="grade-a">-</div>
          </div>
          
          <div class="score-comparison">
            <div class="score-arrow" id="score-arrow">‚Üî</div>
            <div class="score-improvement" id="score-improvement">-</div>
          </div>
          
          <div class="score-card">
            <div class="score-header">Query B Optimization</div>
            <div class="score-value" id="score-b">-</div>
            <div class="score-grade" id="grade-b">-</div>
          </div>
        </div>

        <!-- Key Findings -->
        <div class="findings-section">
          <h5>Key Findings</h5>
          <div class="findings-grid">
            <div class="finding-category">
              <h6>üöÄ Performance Issues</h6>
              <ul id="performance-issues">
                <!-- Populated by JavaScript -->
              </ul>
            </div>
            
            <div class="finding-category">
              <h6>üìä Index Usage</h6>
              <ul id="index-findings">
                <!-- Populated by JavaScript -->
              </ul>
            </div>
            
            <div class="finding-category">
              <h6>üîß Optimization Opportunities</h6>
              <ul id="optimization-opportunities">
                <!-- Populated by JavaScript -->
              </ul>
            </div>
          </div>
        </div>

        <!-- Recommendations -->
        <div class="recommendations-section">
          <h5>Recommended Actions</h5>
          <div class="recommendations-list" id="recommendations-list">
            <!-- Dynamically populated recommendations -->
          </div>
        </div>

        <!-- Traditional Insights -->
        <div class="insights-list" id="insights-list">
          <!-- Dynamically populated insights -->
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div id="comparison-loading" class="comparison-loading" style="display: none;">
      <div class="loading-spinner"></div>
      <p>Comparing queries...</p>
    </div>

    <!-- Empty State -->
    <div id="comparison-empty" class="comparison-empty">
      <div class="empty-icon">‚öñÔ∏è</div>
      <h3>Ready to Compare</h3>
      <p>Select 2 queries from the history bar above to start comparing their performance and execution plans.</p>
    </div>
  </div>
</div> 